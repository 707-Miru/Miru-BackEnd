<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.back.miru.model.dao.PictureDAO">

    <!-- 사진 등록 -->
    <insert id="registPicture" parameterType="Map">
        INSERT INTO picture (id, followId)
        VALUES (#{id}, #{followId})
    </insert>

    <!-- 전체 사진 불러오기 -->
    <select id="selectAllPictures" parameterType="String" resultType="Map">
        SELECT *
        FROM picture
    </select>

    <!-- 전체 태그 불러오기 -->
    <!-- 수정 필요 -->
    <select id="selectAllPictureTag" parameterType="String" resultType="Map">
        SELECT Tag
        FROM picture
    </select>

    <!-- 좋아요 누른 사진 불러오기 -->
    <!-- 한 사진 좋아요 수는 어떻게 세지? -->
    <select id="selectLickPressPictures" parameterType="String" resultType="Map">
        SELECT p.pictureIdx, p.filepath, p.tag, p.publicFlag, p.isPicture
        FROM picture p
                 JOIN favoritepicture f ON (p.pictureIdx = f.pictureIdx)
        WHERE f.user = #{userId}
    </select>

    <!-- 사진 디테일 -->
    <select id="detailPicture" parameterType="String" resultType="Picture">
        SELECT pictureIdx
        FROM picture
        WHERE id = #{id}
    </select>

    <!-- 좋아요 누른 사진들 불러오기 -->
    <select id="getFavoritePictures" parameterType="String" resultType="List">
        SELECT pictureIdx
        FROM picture
        WHERE publicFlag = 1
    </select>

    <!-- 사진 삭제 -->
    <delete id="deletePicture" parameterType="Map">
        DELETE
        FROM picture
        WHERE id = #{id}
          AND followId = #{followId}
    </delete>

</mapper>